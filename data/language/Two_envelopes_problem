{{tone |date=August 2013}} 
The '''two envelopes problem''', also known as the '''exchange paradox''', is a [[brain teaser]], [[puzzle]], or [[paradox]] in [[logic]], [[probability]], and [[recreational mathematics]]. It is of special interest in [[decision theory]], and for the [[Bayesian probability|Bayesian interpretation]] of [[probability|probability theory]]. Historically, it arose as a variant of the [[necktie paradox]].
The problem typically is introduced by formulating a hypothetical challenge of the following type: 
{{Cquote|You are given two indistinguishable [[envelope]]s, each containing money, one contains twice as much as the other. You may pick one envelope and keep the money it contains. Having chosen an envelope at will, but before inspecting it, you are given the chance to switch envelopes. Should you switch?}}
It seems obvious that there is no point in switching envelopes as the situation is symmetric. However, because you stand to gain twice as much money if you switch while risking only a loss of half of what you currently have, it is possible to argue that it is more beneficial to switch.<ref>See the [[Two envelopes problem#Problem|problem statement]] for a more precise statement of this argument.</ref> The problem is to show what is wrong with this argument.

==Introduction==

===Problem===

'''Basic setup''': You are given two indistinguishable envelopes, each of which contains a positive sum of money. One envelope contains twice as much as the other. You may pick one envelope and keep whatever amount it contains. You pick one envelope at random but before you open it you are given the chance to take the other envelope instead.<ref>{{cite journal |first=Ruma |last=Falk |title=The Unrelenting Exchange Paradox |journal=Teaching Statistics |volume=30 |issue=3 |pages=86–88 |year=2008 |doi=10.1111/j.1467-9639.2008.00318.x }}</ref>

'''The switching argument''': Now suppose you reason as follows:
{{ordered list|type=decimal
| I denote by ''A'' the amount in my selected envelope.
| The probability that ''A'' is the smaller amount is 1/2, and that it is the larger amount is also 1/2.
| The other envelope may contain either 2''A'' or ''A''/2.
| If ''A'' is the smaller amount, then the other envelope contains 2''A''.
| If ''A'' is the larger amount, then the other envelope contains ''A''/2.
| Thus the other envelope contains 2''A'' with probability 1/2 and ''A''/2 with probability 1/2.
| So the [[expected value]] of the money in the other envelope is:

:<math>{1 \over 2} (2A) + {1 \over 2} \left({A \over 2}\right) = {5 \over 4}A</math>

|  This is greater than ''A'', so I gain on average by swapping.
| After the switch, I can denote that content by ''B'' and reason in exactly the same manner as above.
| I will conclude that the most rational thing to do is to swap back again.
| To be rational, I will thus end up swapping envelopes indefinitely.
| As it seems more rational to open just any envelope than to swap indefinitely, we have a contradiction.
}}

'''The puzzle''': ''The puzzle is to find the flaw in the very compelling line of reasoning above.'' This includes determining exactly ''why'' and under ''what conditions'' that step is not correct, in order to be sure not to make this mistake in a more complicated situation where the misstep may not be so obvious. In short, the problem is to solve the paradox. Thus, in particular, the puzzle is ''not'' solved by the very simple task of finding another way to calculate the probabilities that does not lead to a contradiction.

==Solutions==
Many solutions resolving the paradox have been presented. The probability theory underlying the problem is well understood, and any apparent paradox is generally due to treating what is actually a conditional probability as an unconditional probability.<ref name="McDonnell 2011 2825–2851">{{cite journal |first=Mark D |last= McDonnell |first2= Alex J |last2= Grant |first3= Ingmar | last3 = Land |first4=Badri N |last4=Vellambi |first5=Derek |last5=Abbott |first6=Ken |last6=Lever |title= Gain from the two-envelope problem via information asymmetry: on the suboptimality of randomized switching |journal = [[Proceedings of the Royal Society A]] |year=2011 | doi= 10.1098/rspa.2010.0541 |volume=467 |pages=2825–2851|bibcode=2011RSPSA.467.2825M }}</ref>  A large variety of similar formulations of the paradox are possible, and have resulted in a voluminous literature on the subject.<ref>[[Talk:Two envelopes problem/Literature]]</ref>{{Better source|reason=per WP:CIRCULAR|date=November 2017}}

Versions of the problem have continued to spark interest in the fields of [[philosophy]]<ref>{{cite journal |first=Ned |last= Markosian |title= A Simple Solution to the Two Envelope Problem |journal=Logos & Episteme |year=2011 |volume=II |issue= 3 |pages = 347–57}}</ref> and [[game theory]].<ref name="McDonnell 2011 2825–2851"/>

== Simple resolution ==
The total amount in both envelopes is a constant <math>c = 3x</math>, with <math>x</math> in one envelope and <math>2x</math> in the other.<br />If you select the envelope with <math>x</math> first you gain the amount <math>x</math> by swapping. If you select the envelope with <math>2x</math> first you lose the amount <math>x</math> by swapping. So you gain on average <math>G = {1 \over 2} (x) + {1 \over 2} (-x) = {1 \over 2}(x - x) = 0</math> by swapping.<br />Swapping is not better than keeping. The expected value <math>\operatorname{E} = \frac 1 2 2x + \frac 1 2 x = \frac 3 2 x</math> is the same for both the envelopes. Thus no contradiction exists.
<ref>{{citation |last1=Priest |first1=Graham |last2=Restall |first2= Greg |year=2007 |title=Envelopes and Indifference |url= http://consequently.org/papers/envelopes.pdf |journal= Dialogues, Logics and Other Strange Things |publisher=College Publications |pages=135–140}}</ref>

;In simple words
:The famous mystification is evoked by secretly mixing up of two completely different circumstances and situations, giving wrong results.
:The so-called ''"paradox"'' presents two already appointed and already locked envelopes, where one envelope is already locked with twice the amount of the other already locked envelope. Whereas step 6 boldly claims:
::''"Thus the other envelope contains 2A with probability 1/2 and A/2 with probability 1/2."'' – Although, in the given situation, that claim can never be applicable to ''"any A"'' nor to ''"any average A".''  
:This claim is never correct for the situation presented, this claim applies to the ''"Nalebuff asymmetric variant"'' only (see below).
:In the situation presented, the other envelope cannot ''"generally"'' contain 2A, but can contain 2A only in the very specific instance where envelope A, by chance, actually contains the ''smaller'' amount of <small><math>\frac{Total}{3}</math></small>, but nowhere else.
:And the other envelope cannot ''"generally"'' contain A/2, but can contain A/2 only in the very specific instance where envelope A, by chance, actually contains 2<small><math>\frac{Total}{3}</math></small>, but nowhere else.
:So the difference between the two already appointed and locked envelopes is always <small><math>\frac{Total}{3}</math></small>. No ''"average amount A"'' can ever form any initial basis for any ''"expected value"'', as this does not get to the heart of the problem.<ref>{{citation |last1=Priest |first1=Graham |last2=Restall |first2= Greg |year=2007 |title=Envelopes and Indifference |url= http://consequently.org/papers/envelopes.pdf |journal= Dialogues, Logics and Other Strange Things |publisher=College Publications |pages=135–140}}</ref>

== Other simple resolutions ==
The step 7 assumes that the second choice is independent of the first choice. This is the error and this is the source of the apparent paradox.<ref>{{citation |last1= Green |first1=Leslie |year=2012 |title=The Two Envelope Paradox |url= http://www.aplusclick.com/pdf/LeslieGreenTwoEnvelopes.pdf}}</ref>

A common way to resolve the paradox, both in popular literature and part of the academic literature, especially in philosophy, is to assume that the 'A' in step 7 is intended to be the [[expected value]] in envelope A and that we intended to write down a formula for the expected value in envelope B.

Step 7 states that the expected value in B =  1/2( 2A + A/2 )

It is pointed out that the 'A' in the first part of the formula is the expected value, given that envelope A contains less than envelope B, but the 'A', in the second part of the formula is the expected value in A, given that envelope A contains more than envelope B. The flaw in the argument is that same symbol is used with two different meanings in both parts of the same calculation but is assumed to have the same value in both cases.

A correct calculation would be:

:Expected value in B = 1/2 ( (Expected value in B, given A is larger than B) + (Expected value in B, given A is smaller than B) )<ref>{{citation |last1= Schwitzgebe |first1=Eric |last2=Dever |first2= Josh |year=2008 |title=The Two Envelope Paradox and Using Variables Within the Expectation Formula |url= http://sorites.org/Issue_20/sorites20.pdf|journal=Sorites|pages=135–140}}</ref>

If we then take the sum in one envelope to be x and the sum in the other to be 2x the expected value calculations becomes:

:Expected value in B = 1/2 (''x'' + 2''x'')

which is equal to the expected sum in A.

In non-technical language, what goes wrong (see [[Necktie paradox]]) is that, in the scenario provided, the mathematics use relative values of A and B (that is, it assumes that one would gain more money if A is less than B than one would lose if the opposite were true). However, the two values of money are fixed (one envelope contains, say, $20 and the other $40). If the values of the envelopes are restated as ''x'' and 2''x'', it's much easier to see that, if A were greater, one would lose ''x'' by switching and, if B were greater, one would gain ''x'' by switching. One does not actually gain a greater amount of money by switching because the total ''T'' of A and B (3''x'') remains the same, and the difference ''x'' is fixed to ''T/3''.

Line 7 should have been worked out more carefully as follows:
:<math>\begin{align}
\operatorname{E}(B) &= \operatorname{E}(B\mid A < B) P(A < B) + \operatorname{E}(B\mid A > B) P(A > B)  \\
&= \operatorname{E}(2A\mid A < B) \frac 1 2 + \operatorname{E}\left(\frac 1 2 A \mid A > B\right) \frac 1  2 \\
&= \operatorname{E}(A \mid A < B) + \frac 1 4 \operatorname{E}(A \mid A >B)
\end{align}</math>
A will be larger when A is larger than B, than when it is smaller than B. So its average values (expectation values) in those two cases are different. And the average value of A is not the same as A itself, anyway. Two mistakes are being made: the writer forgot he was taking expectation values, and he forgot he was taking expectation values under two different conditions.

It would have been easier to compute E(B) directly. Denoting the lower of the two amounts by ''x'',  and taking it to be fixed (even if unknown) we find that

:<math>\operatorname{E}(B) = \frac 1 2 2x + \frac 1 2 x = \frac 3 2 x</math>

We learn that 1.5''x'' is the expected value of the amount in Envelope B. By the same calculation it is also the expected value of the amount in Envelope A. They are the same hence there is no reason to prefer one envelope to the other. This conclusion was, of course, obvious in advance; the point is that we identified the false step in the argument for switching by explaining exactly where the calculation being made there went off the rails.

We could also continue from the correct but difficult to interpret result of the development in line 7:
:<math>\operatorname{E}(B) = \operatorname{E}(A\mid A < B) +
 \frac 1 4 \operatorname{E}(A \mid A >B) = x + \frac 1 4 2x =  \frac 3 2 x</math>
so (of course) different routes to calculate the same thing all give the same answer.

Tsikogiannopoulos (2012)<ref name="Tsikogiannopoulos">{{cite journal |last=Tsikogiannopoulos |first=Panagiotis |year=2012 |title=Παραλλαγές του προβλήματος της ανταλλαγής φακέλων |trans-title=Variations on the Two Envelopes Problem |arxiv=1411.2823|language=Greek |journal=Mathematical Reviews |publisher=Hellenic Mathematical Society|bibcode=2014arXiv1411.2823T }}</ref> presented a different way to do these calculations. Of course, it is by definition correct to assign equal probabilities to the events that the other envelope contains double or half that amount in envelope A. So the "switching argument" is correct up to step 6. Given that the player's envelope contains the amount A, he differentiates the actual situation in two different games: The first game would be played with the amounts (A, 2A) and the second game with the amounts (A/2, A). Only one of them is actually played but we don't know which one. These two games need to be treated differently. If the player wants to compute his/her expected return (profit or loss) in case of exchange, he/she should weigh the return derived from each game by the average amount in the two envelopes in that particular game. In the first case the profit would be A with an average amount of 3A/2, whereas in the second case the loss would be A/2 with an average amount of 3A/4. So the formula of the expected return in case of exchange, seen as a proportion of the total amount in the two envelopes, is:
::<math>E=\frac{1}{2}\cdot\frac{+A}{3A/2}+\frac{1}{2}\cdot\frac{-A/2}{3A/4}=0</math>
This result means yet again that the player has to expect neither profit nor loss by exchanging his/her envelope.

We could actually open our envelope before deciding on switching or not and the above formula would still give us the correct expected return. For example, if we opened our envelope and saw that it contained 100 euros then we would set A=100 in the above formula and the expected return in case of switching would be:
::<math>E=\frac{1}{2}\cdot\frac{+100}{150}+\frac{1}{2}\cdot\frac{-50}{75}=0</math>

=== Nalebuff asymmetric variant ===
As pointed out by many authors,<ref name="Tsikogiannopoulos"/><ref>{{citation |last1=Priest |first1=Graham |last2=Restall |first2= Greg |year=2007 |title=Envelopes and Indifference |url= http://consequently.org/papers/envelopes.pdf |journal= Dialogues, Logics and Other Strange Things |publisher=College Publications |pages=135–140}}</ref> the mechanism by which the amounts of the two envelopes are determined is crucial for the decision of the player to switch or not his/her envelope. Suppose that the amounts in the two envelopes A and B were not determined by first fixing contents of two envelopes E1 and E2, and then naming them A and B at random (for instance, by the toss of a fair coin; Nickerson and Falk, 2006). Instead, we start right at the beginning by putting some amount in Envelope A, and then fill B in a way which depends both on chance (the toss of a coin) and on what we put in A. Suppose that first of all the amount  ''a'' in Envelope A is fixed in some way or other, and then the amount in Envelope B is fixed, dependent on what is already in A, according to the outcome of a fair coin. Ιf the coin fell Heads then 2''a'' is put in Envelope B, if the coin fell Tails then ''a''/2 is put in Envelope B. If the player was aware of this mechanism, and knows that they hold Envelope A, but don't know the outcome of the coin toss, and doesn't know ''a'', then the switching argument is correct and he/she is recommended to switch envelopes. This version of the problem was introduced by Nalebuff (1988) and is often called the Ali-Baba problem. Notice that there is no need to look in Envelope A in order to decide whether or not to switch.

Many more variants of the problem have been introduced. Nickerson and Falk (2006) systematically survey a total of 8.

== Bayesian resolutions ==
The simple resolution above assumed that the person who invented the argument for switching was trying to calculate the expectation value of the amount in Envelope A, thinking of the two amounts in the envelopes as fixed (''x'' and 2''x''). The only uncertainty is which envelope has the smaller amount ''x''. However many mathematicians and statisticians interpret the argument as an attempt to calculate the expected amount in Envelope B, given a real or hypothetical amount "A" in Envelope A. (A mathematician would moreover prefer to use the symbol ''a'' to stand for a possible value, reserving the symbol ''A'' for a random variable). One does not need to look in the envelope to see how much is in there, in order to do the calculation. If the result of the calculation is an advice to switch envelopes, whatever amount might be in there, then it would appear that one should switch anyway, without looking. In this case, at Steps 6, 7 and 8 of the reasoning, "A" is any fixed possible value of the amount of money in the first envelope.

This interpretation of the two envelopes problem appears in the first publications in which the paradox was introduced in its present-day form, Gardner (1989) and Nalebuff (1989). It is common in the more mathematical literature on the problem. It also applies to the modification of the problem (which seems to have started with Nalebuff) in which the owner of Envelope A does actually look in his envelope before deciding whether or not to switch; though Nalebuff does also emphasize that there is no need to have the owner of Envelope A look in his envelope. If he imagines looking in it, and if for any amount which he can imagine being in there, he has an argument to switch, then he will decide to switch anyway. Finally, this interpretation was also the core of earlier versions of the two envelopes problem (Littlewood's, Schrödinger's, and Kraitchik's switching paradoxes); see the concluding section, on history of TEP.

This kind of interpretation is often called "Bayesian" because it assumes the writer is also incorporating a prior probability distribution of possible amounts of money in the two envelopes in the switching argument.

=== Simple form of Bayesian resolution ===

The simple resolution depended on a particular interpretation of what the writer of the argument is trying to calculate: namely, it assumed he was after the (unconditional) [[expectation value]] of what's in Envelope B. In the mathematical literature on Two Envelopes Problem a different interpretation is more common, involving the [[conditional expectation]] value (conditional on what might be in Envelope A). To solve this and related interpretations or versions of the problem, most authors use the [[Bayesian probability|Bayesian interpretation]] of probability, which means that probability reasoning is not only applied to truly random events like the random pick of an envelope, but also to our knowledge (or lack of knowledge) about things which are fixed but unknown, like the two amounts originally placed in the two envelopes, before one is picked at random and called "Envelope A". Moreover, according to a long tradition going back at least to [[Laplace]] and his [[principle of insufficient reason]] one is supposed to assign equal probabilities when one has no knowledge at all concerning the possible values of some quantity. Thus the fact that we are not told anything about how the envelopes are filled can already be converted into probability statements about these amounts. No information means that probabilities are equal.

In steps 6 and 7 of the switching argument, the writer imagines that that Envelope A contains a certain amount ''a'', and then seems to believe that given that information, the other envelope would be equally likely to contain twice or half that amount. That assumption can only be correct, if prior to knowing what was in Envelope A, the writer would have considered the following two pairs of values for both envelopes equally likely: the amounts ''a''/2 and ''a''; and the amounts ''a'' and 2''a''. (This follows from [[Bayes' rule]] in odds form: posterior odds equal prior odds times likelihood ratio). But now we can apply the same reasoning, imagining not ''a'' but ''a/2'' in Envelope A. And similarly, for 2''a''. And similarly, ad infinitum, repeatedly halving or repeatedly doubling as many times as you like. (Falk and Konold, 1992).

Suppose for the sake of argument, we start by imagining an amount 32 in Envelope A. In order that the reasoning in steps 6 and 7 is correct ''whatever'' amount happened to be in Envelope A, we apparently believe in advance that all the following ten amounts are all equally likely to be the smaller of the two amounts in the two envelopes: 1, 2, 4, 8, 16, 32, 64, 128, 256, 512 (equally likely powers of 2: Falk and Konold, 1992). But going to even larger or even smaller amounts, the "equally likely" assumption starts to appear a bit unreasonable. Suppose we stop, just with these ten equally likely possibilities for the smaller amount in the two envelopes. In that case, the reasoning in steps 6 and 7 was entirely correct if envelope A happened to contain any of the amounts 2, 4, ... 512: switching envelopes would give an expected (average) gain of 25%. If envelope A happened to contain the amount 1, then the expected gain is actually 100%. But if it happened to contain the amount 1024, a massive loss of 50% (of a rather large amount) would have been incurred. That only happens once in twenty times, but it is exactly enough to balance the expected gains in the other 19 out of 20 times.

Alternatively we do go on ad infinitum but now we are working with a quite ludicrous assumption, implying for instance, that it is infinitely more likely for the amount in envelope A to be smaller than 1, ''and'' infinitely more likely to be larger than 1024, than between those two values. This is a so-called [[Prior probability|improper prior distribution]]: probability calculus breaks down; expectation values are not even defined; see Falk and Konold and (1982).

Many authors have also pointed out that if a maximum sum that can be put in the envelope with the smaller amount exists, then it is very easy to see that Step 6 breaks down, since if the player holds more than the maximum sum that can be put into the "smaller" envelope they must hold the envelope containing the larger sum, and are thus certain to lose by switching.  This may not occur often, but when it does, the heavy loss the player incurs means that, on average, there is no advantage in switching.  Some writers consider that this resolves all practical cases of the problem.<ref>{{Citation | first = Barry | last = Nalebuff | title = Puzzles: The Other Person’s Envelope is Always Greener | journal = Journal of Economic Perspectives | volume = 3 | issue = 1 | pages = 171–81 | doi=10.1257/jep.3.1.171}}.</ref>

But the problem can also be resolved mathematically without assuming a maximum amount. Nalebuff (1989), Christensen and Utts (1992), Falk and Konold (1992), Blachman, Christensen and Utts (1996),<ref>{{cite journal |first=NM |last=Blachman |first2=R |last2=Christensen |first3=J |last3= Utts |year= 1996 | journal =The American Statistician |volume=50 |issue=1 |pages= 98–99 | doi = 10.1080/00031305.1996.10473551 |title=Letters to the Editor}}</ref> Nickerson and Falk (2006), pointed out that if the amounts of money in the two envelopes have any proper probability distribution representing the player's prior beliefs about the amounts of money in the two envelopes, then it is impossible that whatever the amount ''A=a'' in the first envelope might be, it would be equally likely, according to these prior beliefs, that the second contains ''a''/2 or 2''a''. Thus step 6 of the argument, which leads to ''always switching'', is a non-sequitur, also when there is no maximum to the amounts in the envelopes.

===Introduction to further developments in connection with Bayesian probability theory===
The first two resolutions discussed above (the "simple resolution" and the "Bayesian resolution") correspond to two possible interpretations of what is going on in step 6 of the argument. They both assume that step 6 indeed is "the bad step". But the description in step 6 is ambiguous. Is the author after the unconditional (overall) expectation value of what is in envelope B (perhaps - conditional on the smaller amount, ''x''), or is he after the conditional expectation of what is in envelope B, given any possible amount ''a'' which might be in envelope A?  Thus, there are two main interpretations of the intention of the composer of the paradoxical argument for switching, and two main resolutions.

A large literature has developed concerning variants of the problem.<ref>{{Citation | first = Casper | last = Albers | chapter = 2. Trying to resolve the two-envelope problem | type = thesis | title = Distributional Inference: The Limits of Reason |date=March 2003}}.</ref><ref>{{Citation | last1 = Albers | first1 = Casper J | last2 = Kooi | first2 = Barteld P | last3 = Schaafsma | first3 = Willem | year = 2005 | title = Trying to resolve the two-envelope problem | newspaper = Synthese | volume = 145 | issue = 1 | page = 91}}.</ref>  The standard assumption about the way the envelopes are set up is that a sum of money is in one envelope, and twice that sum is in another envelope. One of the two envelopes is randomly given to the player (''envelope A'').  The originally proposed problem does not make clear exactly how the smaller of the two sums is determined, what values it could possibly take and, in particular, whether there is a minimum or a maximum sum it might contain.<ref>{{Citation | first1 = Ruma | last1 = Falk | first2 = Raymond | last2 = Nickerson | title = An inside look at the two envelopes paradox | journal = Teaching Statistics | volume = 31 | issue = 2 | pages = 39–41 | doi=10.1111/j.1467-9639.2009.00346.x}}.</ref><ref>{{Citation | first = Jeff | last = Chen | title = The Puzzle of the Two-Envelope Puzzle—a Logical Approach | edition = online | page = 274}}.</ref>  However, if we are using the Bayesian interpretation of probability, then we start by expressing our prior beliefs as to the smaller amount in the two envelopes through a probability distribution. Lack of knowledge can also be expressed in terms of probability.

A first variant within the Bayesian version is to come up with a proper prior probability distribution of the smaller amount of money in the two envelopes, such that when Step 6 is performed properly, the advice is still to prefer Envelope B, whatever might be in Envelope A. So though the specific calculation performed in step 6 was incorrect (there is no proper prior distribution such that, given what is in the first envelope A, the other envelope is always equally likely to be larger or smaller) a correct calculation, depending on what prior we are using, does lead to the result <math>E(B | A = a) > a</math> for all possible values of ''a''.<ref>{{Citation | first = John | last = Broome | title = The Two-envelope Paradox | journal = Analysis | volume = 55 | issue = 1 | pages = 6–11 | doi=10.1093/analys/55.1.6}}.</ref>

In these cases it can be shown that the expected sum in both envelopes is infinite. There is no gain, on average, in swapping.

=== Second mathematical variant ===
Though Bayesian probability theory can resolve the first mathematical interpretation of the paradox above, it turns out that examples can be found of proper probability distributions, such that the expected value of the amount in the second envelope given that in the first does exceed the amount in the first, whatever it might be. The first such example was already given by Nalebuff (1989). See also Christensen and Utts (1992).<ref>{{Citation | first= R | last = Christensen | first2= J | last2= Utts | year= 1992 | journal= The American Statistician | volume= 46 | issue = 4 | pages=274–76 | doi = 10.1080/00031305.1992.10475902 | title=Bayesian Resolution of the "Exchange Paradox"}}.</ref><ref>{{Citation | title = Letter to editor and response | first = DA | last = Binder | year = 1993 | journal = The American Statistician | volume = 47 | number = 2 | page = 160 | doi = 10.1080/00031305.1991.10475791}}.</ref><ref>{{Citation | title = Letter to editor and response | last = Ross | year = 1994 | journal = The American Statistician | volume = 48 | number = 3 | pages = 267–269| doi = 10.1080/00031305.1994.10476075}}.</ref><ref>{{Citation | title = Letter with corrections to the original article | first1 = NM | last1 = Blachman | first2 = R | last2 = Christensen | first3 = JM | last3 = Utts | year = 1996 | journal = The American Statistician | volume = 50 | number = 1 | pages = 98–99 | doi = 10.1080/00031305.1996.10473551}}.</ref>

Denote again the amount of money in the first envelope by ''A'' and that in the second by ''B''.  We think of these as random.  Let ''X'' be the smaller of the two amounts and ''Y=2X'' be the larger.  Notice that once we have fixed a probability distribution for ''X'' then the [[joint probability distribution]] of ''A,B'' is fixed, since ''A,B'' = ''X,Y'' or ''Y,X'' each with probability 1/2, independently of ''X,Y''.

The ''bad step'' 6 in the "always switching" argument led us to the finding ''E(B|A=a)>a'' for all ''a'', and hence to the recommendation to switch, whether or not we know ''a''.  Now, it turns out that one can quite easily invent proper probability distributions for ''X'', the smaller of the two amounts of money, such that this bad conclusion is still true. One example is analysed in more detail, in a moment.

As mentioned before, it cannot be true that whatever ''a'', given ''A=a'', ''B'' is equally likely to be ''a''/2 or 2''a'', but it can be true that whatever ''a'', given ''A=a'', ''B'' is larger in expected value than ''a''.

Suppose for example (Broome, 1995)<ref>{{cite journal |first=John |last=Broome | author-link = John Broome (philosopher) | title=The Two-envelope Paradox |journal=[[Analysis (journal)|Analysis]] |volume=55 |issue=1 | pages = 6–11 |doi=10.1093/analys/55.1.6 |year= 1995}}  A famous example of a proper probability distribution of the amounts of money in the two envelopes, for which <math>E(B|A=a)>a</math> for all ''a''.</ref> that the envelope with the smaller amount actually contains 2<sup>''n''</sup> dollars with probability 2<sup>''n''</sup>/3<sup>''n''+1</sup> where ''n'' = 0, 1, 2,…  These probabilities sum to 1, hence the distribution is a proper prior (for subjectivists) and a completely decent probability law also for frequentists.

Imagine what might be in the first envelope. A sensible strategy would certainly be to swap when the first envelope contains 1, as the other must then contain 2. Suppose on the other hand the first envelope contains 2. In that case there are two possibilities: the envelope pair in front of us is either {1, 2} or {2, 4}. All other pairs are impossible. The [[conditional probability]] that we are dealing with the {1, 2} pair, given that the first envelope contains 2, is
:<math>\begin{align}
P(\{1,2\} \mid 2) &= \frac{P(\{1,2\})/2}{P(\{1,2\})/2+P(\{2,4\})/2} \\
&= \frac{P(\{1,2\})}{P(\{1,2\})+P(\{2,4\})} \\
&= \frac{1/3}{1/3 + 2/9} = 3/5,
\end{align}</math>

and consequently the probability it's the {2, 4} pair is 2/5, since these are the only two possibilities. In this derivation, <math>P(\{1,2\})/2</math> is the probability that the envelope pair is the pair 1 and 2, ''and'' Envelope A happens to contain 2; <math>P(\{2,4\})/2</math> is the probability that the envelope pair is the pair 2 and 4, ''and'' (again) Envelope A happens to contain 2. Those are the only two ways that Envelope A can end up containing the amount 2.

It turns out that these proportions hold in general unless the first envelope contains 1. Denote by ''a'' the amount we imagine finding in Envelope A, if we were to open that envelope, and suppose that ''a'' = 2<sup>''n''</sup> for some ''n'' ≥ 1. In that case the other envelope contains ''a''/2 with probability 3/5 and 2''a'' with probability 2/5.

So either the first envelope contains 1, in which case the conditional expected amount in the other envelope is 2, or the first envelope contains ''a'' > 1, and though the second envelope is more likely to be smaller than larger, its conditionally expected amount is larger: the conditionally expected amount in Envelope B is
:<math>\frac{3}{5} \frac{a}{2} + \frac{2}{5} 2a = \frac{11}{10}a</math>

which is more than ''a''. This means that the player who looks in Envelope A would decide to switch whatever he saw there. Hence there is no need to look in Envelope A to make that decision.

This conclusion is just as clearly wrong as it was in the preceding interpretations of the Two Envelopes Problem. But now the flaws noted above do not apply; the ''a'' in the expected value calculation is a constant and the conditional probabilities in the formula are obtained from a specified and proper prior distribution.

===Proposed resolutions through mathematical economics===
Most writers think that the new paradox can be defused, although the resolution requires concepts from mathematical economics.<ref>{{cite journal |first=D. A. |last=Binder |year=1993 |title= Letters to the Editor|journal=The American Statistician |volume=47 |issue=2 |pages=160 | doi = 10.1080/00031305.1993.10475966 }} Comment on Christensen and Utts (1992)</ref> Suppose <math>E(B|A=a)>a</math> for all ''a''. It can be shown that this is possible for some probability distributions of ''X'' (the smaller amount of money in the two envelopes) only if <math>E(X)=\infty</math>. That is, only if the mean of all possible values of money in the envelopes is infinite. To see why, compare the series described above in which the probability of each ''X'' is 2/3 as likely as the previous ''X'' with one in which the probability of each ''X'' is only 1/3 as likely as the previous ''X''. When the probability of each subsequent term is greater than one-half of the probability of the term before it (and each ''X'' is twice that of the ''X'' before it) the mean is infinite, but when the probability factor is less than one-half, the mean converges. In the cases where the probability factor is less than one-half, <math>E(B|A=a)<a</math> for all ''a'' other than the first, smallest ''a'', and the total expected value of switching converges to 0. In addition, if an ongoing distribution with a probability factor greater than one-half is made finite by, after any number of terms, establishing a final term with "all the remaining probability," that is, 1 minus the probability of all previous terms, the expected value of switching with respect to the probability that ''A'' is equal to the last, largest ''a'' will exactly negate the sum of the positive expected values that came before, and again the total expected value of switching drops to 0 (this is the general case of setting out an equal probability of a finite set of values in the envelopes described above). Thus, the only distributions that seem to point to a positive expected value for switching are those in which <math>E(X)=\infty</math>. Averaging over ''a'', it follows that <math>E(B)=E(A)=\infty</math> (because ''A'' and ''B'' have identical probability distributions, by symmetry, and both ''A'' and ''B'' are greater than or equal to ''X'').

If we don't look into the first envelope, then clearly there is no reason to switch, since we would be exchanging one unknown amount of money (''A''), whose expected value is infinite, for another unknown amount of money (''B''), with the same probability distribution and infinite expected value. However, if we do look into the first envelope, then for all values observed (<math>A=a</math>) we would want to switch because <math>E(B|A=a)>a</math> for all ''a''. As noted by [[David Chalmers]] (2002), this problem can be described as a failure of dominance reasoning.<ref name="consc.net">{{cite journal |first=David J. |last=Chalmers |title=The St. Petersburg Two-Envelope Paradox |journal=Analysis |volume=62 |issue=2 |pages=155–157 |year=2002 |doi=10.1093/analys/62.2.155 }}</ref>

Under dominance reasoning, the fact that we strictly prefer ''A'' to ''B'' for all possible observed values ''a'' should imply that we strictly prefer ''A'' to ''B'' without observing ''a''; however, as already shown, that is not true because <math>E(B)=E(A)=\infty</math>. To salvage dominance reasoning while allowing <math>E(B)=E(A)=\infty</math>, one would have to replace expected value as the decision criterion, thereby employing a more sophisticated argument from mathematical economics.

For example, we could assume the decision maker is an [[expected utility]] maximizer with initial wealth ''W'' whose utility function, <math>u(w)</math>, is chosen to satisfy <math>E(u(W+B)|A=a)<u(W+a)</math> for at least some values of ''a'' (that is, holding onto <math>A=a</math> is strictly preferred to switching to ''B'' for some ''a''). Although this is not true for all utility functions, it would be true if <math>u(w)</math> had an upper bound, <math>\beta<\infty</math>, as ''w'' increased toward infinity (a common assumption in mathematical economics and decision theory).<ref>{{cite book|last1=DeGroot|first1=Morris H.|title=Optimal Statistical Decisions|date=1970|publisher=McGraw-Hill|pages=109}}</ref> [[Michael R. Powers]] (2015) provides necessary and sufficient conditions for the utility function to resolve the paradox, and notes that neither <math>u(w)<\beta</math> nor <math>E(u(W+A))=E(u(W+B))<\infty</math> is required.<ref>{{cite journal|last1=Powers|first1=Michael R.|title=Paradox-Proof Utility Functions for Heavy-Tailed Payoffs: Two Instructive Two-Envelope Problems|journal=Risks|date=2015|volume=3|issue=1|pages=26–34|doi=10.3390/risks3010026}}</ref>

Some writers would prefer to argue that in a real-life situation, <math>u(W+A)</math> and <math>u(W+B)</math> are bounded simply because the amount of money in an envelope is bounded by the total amount of money in the world (''M''), implying <math>u(W+A) \leq u(W+M)</math> and <math>u(W+B) \leq u(W+M)</math>. From this perspective, the second paradox is resolved because the postulated probability distribution for ''X'' (with <math>E(X)=\infty</math>) cannot arise in a real-life situation. Similar arguments are often used to resolve the [[St. Petersburg paradox]].

=== Controversy among philosophers ===
As mentioned above, ''any distribution'' producing this variant of the paradox must have an infinite mean. So before the player opens an envelope the expected gain from switching is "∞ − ∞", which is not defined. In the words of [[David Chalmers]] (2002), this is "just another example of a familiar phenomenon, the strange behaviour of infinity".<ref name="consc.net"/> Chalmers suggests that [[decision theory]] generally breaks down when confronted with games having a diverging expectation, and compares it with the situation generated by the classical [[St. Petersburg paradox]].

However, Clark and Shackel argue that this blaming it all on "the strange behaviour of infinity" does not resolve the paradox at all; neither in the single case nor the averaged case. They provide a simple example of a pair of random variables both having infinite mean but where it is clearly sensible to prefer one to the other, both conditionally and on average.<ref>{{cite journal |last=Clark |first=M. |last2=Shackel |first2=N. |title=The Two-Envelope Paradox |journal=Mind |volume=109 |issue=435 |pages=415–442 |year=2000 |doi=10.1093/mind/109.435.415 }}</ref> They argue that decision theory should be extended so as to allow infinite expectation values in some situations.

==Smullyan's non-probabilistic variant==
The logician [[Raymond Smullyan]] questioned if the paradox has anything to do with probabilities at all.<ref>{{cite book | last = Smullyan | first = Raymond | authorlink = Raymond Smullyan | publisher = [[Alfred A. Knopf]] | title = Satan, Cantor, and infinity and other mind-boggling puzzles | year = 1992 | pages = 189–192 | isbn = 0-679-40688-3}}</ref> He did this by expressing the problem in a way that does not involve probabilities. The following plainly logical arguments lead to conflicting conclusions:

#Let the amount in the envelope chosen by the player be ''A''. By swapping, the player may gain ''A'' or lose ''A''/2. So the potential gain is strictly greater than the potential loss.
#Let the amounts in the envelopes be ''X'' and 2''X''. Now by swapping, the player may gain ''X'' or lose ''X''. So the potential gain is equal to the potential loss.

===Proposed resolutions===
A number of solutions have been put forward. Careful analyses have been made by some logicians. Though solutions differ, they all pinpoint semantic issues concerned with [[counterfactual thinking|counterfactual]] reasoning. We want to compare the amount that we would gain by switching if we would gain by switching, with the amount we would lose by switching if we would indeed lose by switching. However, we cannot both gain and lose by switching at the same time. We are asked to compare two incompatible situations. Only one of them can factually occur, the other is a counterfactual situation—somehow imaginary.  To compare them at all, we must somehow "align" the two situations, providing some definite points in common.

James Chase (2002) argues that the second argument is correct because it does correspond to the way to align two situations (one in which we gain, the other in which we lose), which is preferably indicated by the problem description.<ref>{{cite journal |first=James |last=Chase |year=2002 |title=The Non-Probabilistic Two Envelope Paradox |journal=Analysis |volume=62 |issue=2 |pages=157–160 |doi=10.1093/analys/62.2.157 }}</ref> Also Bernard Katz and Doris Olin (2007) argue this point of view.<ref>{{cite journal |first=Bernard |last=Katz |first2=Doris |last2=Olin |year=2007 |title=A tale of two envelopes |journal=[[Mind (journal)|Mind]] |volume=116 |issue=464 |pages=903–926 |doi=10.1093/mind/fzm903 }}</ref> In the second argument, we consider the amounts of money in the two envelopes as being fixed; what varies is which one is first given to the player. Because that was an arbitrary and physical choice, the ''counterfactual world'' in which the player, counterfactually, got the other envelope to the one he was actually (factually) given is a highly meaningful counterfactual world and hence the comparison between gains and losses in the two worlds is meaningful. This comparison is uniquely indicated by the problem description, in which two amounts of money are put in the two envelopes first, and only after that is one chosen arbitrarily and given to the player.  In the first argument, however, we consider the amount of money in the envelope first given to the player as fixed and consider the situations where the second envelope contains either half or twice that amount. This would only be a reasonable counterfactual world if in reality the envelopes had been filled as follows: first, some amount of money is placed in the specific envelope that will be given to the player; and secondly, by some arbitrary process, the other envelope is filled (arbitrarily or randomly) either with double or with half of that amount of money.

Byeong-Uk Yi (2009), on the other hand, argues that comparing the amount you would gain if you would gain by switching with the amount you would lose if you would lose by switching is a meaningless exercise from the outset.<ref>{{cite journal |author=Byeong-Uk Yi |year=2009 |title=The Two-envelope Paradox With No Probability |url=http://philosophy.utoronto.ca/people/linked-documents-people/c%20two%20envelope%20with%20no%20probability.pdf |deadurl=yes |archiveurl=https://web.archive.org/web/20110929034017/http://philosophy.utoronto.ca/people/linked-documents-people/c%20two%20envelope%20with%20no%20probability.pdf |archivedate=2011-09-29 |df= }}</ref>  According to his analysis, all three implications (switch, indifferent, do not switch) are incorrect. He analyses Smullyan's arguments in detail, showing that intermediate steps are being taken, and pinpointing exactly where an incorrect inference is made according to his formalization of counterfactual inference. An important difference with Chase's analysis is that he does not take account of the part of the story where we are told that the envelope called Envelope A is decided completely at random. Thus, Chase puts probability back into the problem description in order to conclude that arguments 1 and 3 are incorrect, argument 2 is correct, while Yi keeps "two envelope problem without probability" completely free of probability, and comes to the conclusion that there are no reasons to prefer any action. This corresponds to the view of Albers et al., that without probability ingredient, there is no way to argue that one action is better than another, anyway.

In a 2012 paper on the subject, Bliss argues that the source of the paradox is that when one mistakenly believes in the possibility of a larger payoff that does not, in actuality, exist, one is mistaken by a larger margin than when one believes in the possibility of a smaller payoff that does not actually exist.<ref>{{cite journal |author=Bliss |year=2012 |title=A Concise Resolution to the Two Envelope Paradox |arxiv=1202.4669|bibcode=2012arXiv1202.4669B }}</ref> If, for example, the envelopes contained $5.00 and $10.00 respectively, a player who opened the $10.00 envelope would expect the possibility of a $20.00 payout that simply does not exist. Were that player to open the $5.00 envelope instead, he would believe in the possibility of a $2.50 payout, which constitutes a smaller deviation from the true value; this results in the paradoxical discrepancy.

Albers, Kooi, and Schaafsma (2005) consider that without adding probability (or other) ingredients to the problem, Smullyan's arguments do not give any reason to swap or not to swap, in any case. Thus, there is no paradox. This dismissive attitude is common among writers from probability and economics: Smullyan's paradox arises precisely because he takes no account whatever of probability or utility.

==Extensions to the problem==
Since the two envelopes problem became popular, many authors have studied the problem in depth in the situation in which the player has a prior probability distribution of the values in the two envelopes, and does look in Envelope A. One of the most recent such publications is by McDonnell and Douglas (2009), who also consider some further generalizations.<ref name="rspa">{{cite journal |last=McDonnell |first=M. D. |last2=Abott |first2=D. |title=Randomized switching in the two-envelope problem |journal=[[Proceedings of the Royal Society A]] |volume=465 |issue=2111 |pages=3309–3322 |year=2009 |doi=10.1098/rspa.2009.0312 |bibcode=2009RSPSA.465.3309M }}</ref>

If ''a priori'' we know that the amount in the smaller envelope is a whole number of some currency units, then the problem is determined, as far as probability theory is concerned, by the probability mass function <math>p(x)</math> describing our prior beliefs that the smaller amount is any number ''x'' = 1,2, ... ; the summation over all values of ''x'' being equal to 1. It follows that given the amount ''a'' in Envelope A, the amount in Envelope B is certainly 2''a'' if ''a'' is an odd number. However, if ''a'' is even, then the amount in Envelope B is 2''a'' with probability <math>p(a)/(p(a/2)+p(a))</math>, and ''a''/2 with probability <math>p(a/2)/(p(a/2)+p(a))</math>. If one would like to switch envelopes if the expectation value of what is in the other is larger than what we have in ours, then a simple calculation shows that one should switch if <math> p(a/2) < 2p(a) </math>, keep to Envelope A if <math> p(a/2) > 2p(a) </math>.

If on the other hand the smaller amount of money can vary continuously, and we represent our prior beliefs about it with a probability density <math>f(x)</math>, thus a function that integrates to one when we integrate over ''x'' running from zero to infinity, then given the amount ''a'' in Envelope A, the other envelope contains 2''a'' with probability <math>2f(a)/(f(a/2)+2f(a))</math>, and ''a''/2 with probability <math>f(a/2)/(f(a/2)+2f(a))</math>. If again we decide to switch or not according to the expectation value of what's in the other envelope, the criterion for switching now becomes <math> f(a/2) < 4f(a) </math>.

The difference between the results for discrete and continuous variables may surprise many readers. Speaking intuitively, this is explained as follows. Let ''h'' be a small quantity and imagine that the amount of money we see when we look in Envelope A is rounded off in such a way that differences smaller than ''h'' are not noticeable, even though actually it varies continuously. The probability that the smaller amount of money is in an interval around ''a'' of length ''h'', and Envelope A contains the smaller amount is approximately <math>f(a) \cdot h \cdot (1/2)</math>. The probability that the larger amount of money is in an interval around ''a'' of length ''h'' corresponds to the smaller amount being in an interval of length ''h''/2 around ''a''/2. Hence the probability that the larger amount of money is in a small interval around ''a'' of length ''h'' and Envelope A contains the larger amount is approximately <math>f(a/2) \cdot (h/2) \cdot (1/2)</math>. Thus, given Envelope A contains an amount about equal to ''a'', the probability it is the smaller of the two is roughly <math>f(a) \cdot h \cdot (1/2)/(f(a) \cdot h \cdot (1/2)+f(a/2) \cdot (h/2) \cdot (1/2)) = 2f(a)/(2f(a)+f(a/2))</math>.

If the player only wants to end up with the ''larger'' amount of money, and does not care about expected amounts, then in the discrete case he should switch if ''a'' is an odd number, or if ''a'' is even and <math>p(a/2) < p(a)</math>. In the continuous case he should switch if <math> f(a/2) < 2f(a) </math>.

Some authors prefer to think of probability in a frequentist sense. If the player knows the probability distribution used by the organizer to determine the smaller of the two values, then the analysis would proceed just as in the case when ''p'' or ''f'' represents subjective prior beliefs. However, what if we take a frequentist point of view, but the player does not know what probability distribution is used by the organiser to fix the amounts of money in any one instance? Thinking of the arranger of the game and the player as two parties in a two-person game, puts the problem into the range of [[game theory]]. The arranger's strategy consists of a choice of a probability distribution of ''x'', the smaller of the two amounts. Allowing the player also to use randomness in making his decision, his strategy is determined by his choosing a probability of switching <math>q(a)</math> for each possible amount of money ''a'' he might see in Envelope A. In this section we so far only discussed ''fixed strategies'', that is strategies for which ''q'' only takes the values 0 and 1, and we saw that the player is fine with a fixed strategy, if he knows the strategy of the organizer. In the next section we will see that randomized strategies can be useful when the organizer's strategy is not known.

==Randomized solutions==
Suppose as in the previous section that the player is allowed to look in the first envelope before deciding whether to switch or to stay. We'll think of the contents of the two envelopes as being two positive numbers, not necessarily two amounts of money. The player is allowed either to keep the number in Envelope A, or to switch and take the number in Envelope B. We'll drop the assumption that one number is exactly twice the other, we'll just suppose that they are different and positive.  On the other hand, instead of trying to maximize expectation values, we'll just try to maximize the chance that we end up with the larger number.

In this section we ask the question, is it possible for the player to make his choice in such a way that he goes home with the larger number with probability strictly greater than half, however the organizer has filled the two envelopes?

We are given no information at all about the two numbers in the two envelopes, except that they are different, and strictly greater than zero. The numbers were written down on slips of paper by the organiser, put into the two envelopes. The envelopes were then shuffled, the player picks one, calls it Envelope A, and opens it.

We are not told any joint probability distribution of the two numbers. We are not asking for a [[subjectivist]] solution. We must think of the two numbers in the envelopes as chosen by the arranger of the game according to some possibly random procedure, completely unknown to us, and fixed.  Think of each envelope as simply containing a positive number and such that the two numbers are not the same. The job of the player is to end up with the envelope with the larger number. This variant of the problem, as well as its solution, is attributed by [[Mark D. McDonnell|McDonnell]] and [[Derek Abbott|Abbott]], and by earlier authors, to information theorist [[Thomas M. Cover]].<ref name="TCover">{{cite book | last = Cover | first = Thomas M | authorlink = Thomas M. Cover | year = 1987 | editor1-last = Cover | editor1-first = T | editor2-last = Gopinath | editor2-first = B | title = Open Problems in Communication and Computation | chapter= Pick the largest number | publisher = [[Springer-Verlag]]}}</ref>

Counter-intuitive though it might seem, there is a way that the player can decide whether to switch or to stay so that he has a larger chance than 1/2 of finishing with the bigger number, however the two numbers are chosen by the arranger of the game. However, it is only possible with a so-called [[randomized algorithm]]: the player must be able to generate his own [[Statistical randomness|random numbers]]. Suppose he is able to produce a random number, let's call it ''Z'', such that the probability that ''Z'' is larger than any particular quantity ''z'' is exp(-''z''). Note that exp(-''z'') starts off equal to 1 at ''z''=0 and decreases strictly and continuously as ''z'' increases, tending to zero as ''z'' tends to infinity.  So the chance is 0 that ''Z'' is exactly equal to any particular number, and there is a positive probability that ''Z'' lies between any two particular different numbers. The player compares his ''Z'' with the number in Envelope A. If ''Z'' is smaller he keeps the envelope. If ''Z'' is larger he switches to the other envelope.

Think of the two numbers in the envelopes as fixed (though of course unknown to the player). Think of the player's random ''Z'' as a probe with which he decides whether the number in Envelope A is small or large. If it is small compared to ''Z'' he switches, if it is large compared to ''Z'' he stays.

If ''both'' numbers are smaller than the player's ''Z'', his strategy does not help him. He ends up with the Envelope B, which is equally likely to be the larger or the smaller of the two. If ''both'' numbers are larger than ''Z'' his strategy does not help him either, he ends up with the first Envelope A, which again is equally likely to be the larger or the smaller of the two. However, if ''Z'' happens to be in between the two numbers, then his strategy leads him correctly to keep Envelope A if its contents are larger than those of B, but to switch to Envelope B if A has smaller contents than B. Altogether, this means that he ends up with the envelope with the larger number with probability strictly larger than 1/2. To be precise, the probability that he ends with the "winning envelope" is 1/2  + P(''Z'' falls between the two numbers)/2.

In practice, the number ''Z'' we have described could be determined to the necessary degree of accuracy as follows. Toss a fair coin many times, and convert the sequence of heads and tails into the binary representation of a number ''U'' between 0 and 1: for instance, HTHHTH... becomes the binary representation of ''u''=0.101101.. . In this way, we generate a random number ''U'', uniformly distributed between 0 and 1. Then define ''Z'' = − ln (''U'')  where "ln" stands for natural logarithm, i.e., logarithm to base e. Note that we just need to toss the coin long enough to verify whether ''Z'' is smaller or larger than the number ''a'' in the first envelope—we do not need to go on for ever. We only need to toss the coin a finite (though random) number of times: at some point we can be sure that the outcomes of further coin tosses would not change the outcome.

The particular probability law (the so-called standard [[exponential distribution]]) used to generate the random number ''Z'' in this problem is not crucial. Any [[probability distribution]] over the positive real numbers that assigns positive probability to any interval of positive length does the job.

This problem can be considered from the point of view of [[game theory]], where we make the game a two-person zero-sum game with outcomes win or lose, depending on whether the player ends up with the higher or lower amount of money. The organiser chooses the joint distribution of the amounts of money in both envelopes, and the player chooses the distribution of ''Z''. The game does not have a "solution" (or saddle point) in the sense of game theory. This is an infinite game and [[von Neumann]]'s [[minimax theorem]] does not apply.<ref>{{Citation | archiveurl = https://web.archive.org/web/20071114230748/http://www.mit.edu/~emin/writings/envelopes.html | archivedate = 2007-11-14 | url = http://www.mit.edu/~emin/writings/envelopes.html | title = The Two Envelope Problem | first = Emin | last = Martinian}}.</ref>

== History of the paradox ==
The envelope paradox dates back at least to 1953, when [[Belgian]] mathematician [[Maurice Kraitchik]] proposed a puzzle in his book ''Recreational Mathematics''
concerning two equally rich men who meet and compare their beautiful neckties, presents from their wives, wondering which tie actually cost more money. He also introduces a variant in which the two men compare the contents of their purses. He assumes that each purse is equally likely to contain 1 up to some large number ''x'' of pennies, the total number of pennies minted to date. The men do not look in their purses but each reasons that they should switch. He does not explain what is the error in their reasoning. It is not clear whether the puzzle already appeared in an earlier 1942 edition of his book. It is also mentioned in a 1953 book on elementary mathematics and mathematical puzzles by the mathematician [[John Edensor Littlewood]], who credited it to the physicist [[Erwin Schroedinger]], where it concerns a pack of cards, each card has two numbers written on it, the player gets to see a random side of a random card, and the question is whether one should turn over the card. Littlewood's pack of cards is infinitely large and his paradox is a paradox of improper prior distributions.

[[Martin Gardner]] popularized Kraitchik's puzzle in his 1982 book ''Aha! Gotcha'', in the form of a wallet game:

{{Cquote|Two people, equally rich, meet to compare the contents of their wallets. Each is ignorant of the contents of the two wallets. The game is as follows: whoever has the least money receives the contents of the wallet of the other (in the case where the amounts are equal, nothing happens). One of the two men can reason: "I have the amount ''A'' in my wallet. That's the maximum that I could lose. If I win (probability 0.5), the amount that I'll have in my possession at the end of the game will be more than 2''A''. Therefore the game is favourable to me." The other man can reason in exactly the same way. In fact, by symmetry, the game is fair. Where is the mistake in the reasoning of each man?}}

Gardner confessed that though, like Kraitchik, he could give a sound analysis leading to the right answer (there is no point in switching), he could not clearly put his finger on what was wrong with the reasoning for switching, and Kraitchik did not give any help in this 
direction, either. [[F. Thomas Bruss]] on the contrary saw no justification to speak of a paradox (although he did not question the interest of other aspects of the problem), arguing that the crucial expectation argument displaying a paradox is wrong. In the A (2A) (A/2) - version the expectation argument would require measurability of the three random variables on the same probability space, which is here not compatible for two outcomes.<ref>{{cite journal |last=Bruss |first=F. Thomas |authorlink=Franz Thomas Bruss |title=The fallacy of the two-envelope problem |journal= Mathematical Scientist |volume=21 |issue=2 |pages=112–119 |year=1996}}</ref> In the wallet version, the error was to assume that A, independently of its value, is equally likely the smaller amount of A and B, only because both players are assumed to be equally rich.

In 1988 and 1989, [[Barry Nalebuff]] presented two different two-envelope problems, each with one envelope containing twice what is in the other, and each with computation of the expectation value 5''A''/4. The first paper just presents the two problems. The second discusses many solutions to both of them. The second of his two problems is nowadays the more common, and is presented in this article. According to this version, the two envelopes are filled first, then one is chosen at random and called Envelope A. [[Martin Gardner]] independently mentioned this same version in his 1989 book ''Penrose Tiles to Trapdoor Ciphers and the Return of Dr Matrix''.  Barry Nalebuff's asymmetric variant, often known as the Ali Baba problem, has one envelope filled first, called Envelope A, and given to Ali.  Then a fair coin is tossed to decide whether Envelope B should contain half or twice that amount, and only then given to Baba.

== See also ==
* [[Bayesian probability]]
* [[Bertrand's paradox (probability)|Bertrand's paradox]]
* [[Boy or Girl paradox]]
* [[Decision theory]]
* [[Monty Hall problem]]
* [[Necktie paradox]]
* [[Newcomb's paradox]]
* [[Siegel's paradox]]
* [[Sleeping Beauty problem]]
* [[St. Petersburg paradox]]

== Notes and references ==
{{Reflist|30em}}

{{DEFAULTSORT:Two Envelopes Problem}}
[[Category:Probability theory paradoxes]]
[[Category:Decision-making paradoxes]]
[[Category:Probability problems]]